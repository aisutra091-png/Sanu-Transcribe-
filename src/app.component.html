<main class="min-h-screen w-full flex flex-col items-center p-4 sm:p-6 lg:p-8 font-body">
  <div class="w-full max-w-4xl mx-auto">
    <header class="text-center mb-8 relative">
       <button (click)="toggleTheme()" type="button" class="absolute top-0 right-0 p-2 rounded-full text-text-secondary dark:text-text-secondary-dark hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors" [attr.aria-label]="'Toggle theme to ' + (theme() === 'light' ? 'dark' : 'light')">
        @if(theme() === 'light') {
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2.25a.75.75 0 01.75.75v2.25a.75.75 0 01-1.5 0V3a.75.75 0 01.75-.75zM7.5 12a4.5 4.5 0 119 0 4.5 4.5 0 01-9 0zM18.894 6.106a.75.75 0 010 1.06l-1.591 1.59a.75.75 0 11-1.06-1.06l1.59-1.59a.75.75 0 011.06 0zM21.75 12a.75.75 0 01-.75.75h-2.25a.75.75 0 010-1.5H21a.75.75 0 01.75.75zM17.803 17.803a.75.75 0 01-1.06 0l-1.59-1.591a.75.75 0 111.06-1.06l1.59 1.59a.75.75 0 010 1.06zM12 21a.75.75 0 01-.75-.75v-2.25a.75.75 0 011.5 0v2.25a.75.75 0 01-.75.75zM5.197 17.803a.75.75 0 010-1.06l1.59-1.59a.75.75 0 111.06 1.06l-1.59 1.591a.75.75 0 01-1.06 0zM3 12a.75.75 0 01.75-.75h2.25a.75.75 0 010 1.5H3.75A.75.75 0 013 12zM6.106 5.197a.75.75 0 011.06 0l1.59 1.59a.75.75 0 01-1.06 1.06L6.106 6.258a.75.75 0 010-1.06z"/></svg>
        } @else {
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" fill="currentColor"><path d="M12.18 2.25a.75.75 0 01.433 1.373l-.733.424a13.48 13.48 0 00-4.522 4.522l-.424.733A.75.75 0 015.49 8.65a14.98 14.98 0 0112.705-6.045.75.75 0 01.585.852 13.48 13.48 0 00-4.522 4.522l-.424.733a.75.75 0 01-1.373-.433A14.98 14.98 0 0112.18 2.25z"/></svg>
        }
      </button>

      <h1 class="font-display text-4xl sm:text-5xl font-extrabold text-text-primary dark:text-text-primary-dark tracking-tight">
        Sanu Transcribe
      </h1>
      <p class="mt-3 text-lg text-text-secondary dark:text-text-secondary-dark max-w-2xl mx-auto">
        Upload an audio file or record your voice to get a high-quality transcription in seconds.
      </p>
    </header>

    <div class="relative bg-light-card dark:bg-dark-card p-6 sm:p-8 rounded-2xl shadow-xl border border-slate-200 dark:border-slate-700 min-h-[30rem] flex flex-col justify-center">
      @switch (view()) {
        @case ('input') {
          <app-audio-input (audioSubmit)="handleAudio($event)"></app-audio-input>
        }
        @case ('loading') {
          <app-transcription-view [loading]="true"></app-transcription-view>
        }
        @case ('result') {
          @if (transcription(); as currentTranscription) {
            <app-transcription-view 
              [transcription]="currentTranscription"
              (transcribeNew)="transcribeAgain()">
            </app-transcription-view>
          }
        }
        @case ('error') {
          <div class="flex flex-col items-center justify-center text-center space-y-4">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-error dark:text-error-dark" viewBox="0 0 24 24" fill="currentColor">
              <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/>
            </svg>
            <h2 class="text-2xl font-semibold text-error dark:text-error-dark font-display">An Error Occurred</h2>
            <p class="text-slate-500 bg-red-50 dark:bg-opacity-10 dark:text-text-secondary-dark p-3 rounded-md">{{ errorMessage() }}</p>
            <button (click)="transcribeAgain()" class="mt-4 px-6 py-2 bg-primary dark:bg-primary-dark text-white font-semibold rounded-lg shadow-md hover:opacity-90 transition-opacity">
              Try Again
            </button>
          </div>
        }
      }
    </div>
    
    @if (history().length > 0) {
      <app-history-view 
        [history]="history()"
        (itemSelected)="showHistoryItem($event)"
        (historyCleared)="clearHistory()">
      </app-history-view>
    }
  </div>
</main>